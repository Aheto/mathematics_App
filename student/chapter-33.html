<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Mini OpenStax: Create Simple Algebraic Expressions Using Simple Logic to Translate Instructions into Algebraic Form">
  <title>Mini OpenStax ‚Äî Create Simple Algebraic Expressions Using Simple Logic to Translate Instructions into Algebraic Form</title>
  <style>
    :root {
      --green: #006b3d;
      --gold: #cead00;
      --light: #f9f9f9;
      --dark: #2d2d2d;
    }
    body { 
      font-family: 'Segoe UI', system-ui, sans-serif; 
      margin: 0; 
      padding: 0; 
      background: #fff; 
      color: var(--dark); 
      line-height: 1.6;
    }
    .container { 
      max-width: 800px; 
      margin: 0 auto; 
      padding: 1rem; 
    }
    .header { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      margin-bottom: 1rem; 
      flex-wrap: wrap; 
      gap: 0.5rem; 
    }
    .role-badge { 
      background: #e9ecef; 
      padding: 0.25rem 0.5rem; 
      border-radius: 4px; 
      font-size: 0.85rem; 
    }
    .chapter-nav { 
      margin: 1.2rem 0; 
      display: flex; 
      flex-wrap: wrap; 
      gap: 0.4rem; 
      justify-content: center; 
    }
    .chapter-btn {
      padding: 0.4rem 0.8rem; 
      background: var(--green); 
      color: white; 
      text-decoration: none; 
      border-radius: 4px; 
      font-size: 0.9rem;
      min-width: 80px;
      text-align: center;
    }
    .chapter-btn.active, .chapter-btn:hover { 
      background: #00502e; 
    }
    .section { 
      margin-bottom: 1.5rem; 
      padding-bottom: 1rem;
      border-bottom: 1px solid #eee;
    }
    .word-list { 
      display: flex; 
      flex-wrap: wrap; 
      gap: 0.5rem; 
      margin: 0.5rem 0; 
    }
    .word-item { 
      background: var(--light); 
      padding: 0.25rem 0.5rem; 
      border-radius: 4px; 
      font-family: monospace; 
      font-size: 0.95rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0.5rem;
      text-align: left;
    }
    th {
      background-color: #f0f7f4;
    }
    .checkpoint, .thought-experiment {
      background: #f8f9fa;
      padding: 1rem;
      border-left: 4px solid var(--gold);
      margin: 1.5rem 0;
    }
    .quiz { 
      margin-top: 2rem; 
    }
    .question { 
      margin-bottom: 1.2rem; 
    }
    .options { 
      margin-left: 1rem; 
    }
    .option { 
      margin: 0.4rem 0; 
    }
    .btn {
      background: var(--green); 
      color: white; 
      border: none; 
      padding: 0.5rem 1rem;
      border-radius: 4px; 
      cursor: pointer; 
      font-size: 1rem; 
      margin-right: 0.5rem;
      display: inline-block;
    }
    .btn:hover { 
      background: #00502e; 
    }
    .btn-secondary { 
      background: #6c757d; 
    }
    .btn-secondary:hover { 
      background: #5a6268; 
    }
    .feedback { 
      margin-top: 1.5rem; 
      padding: 1rem; 
      background: var(--light); 
      border-left: 4px solid var(--green); 
    }
    footer { 
      text-align: center; 
      margin-top: 2rem; 
      font-size: 0.9rem; 
      padding-top: 1.5rem;
      border-top: 1px solid #eee;
    }
    a { 
      color: var(--green); 
      text-decoration: none; 
    }
    a:hover { 
      text-decoration: underline; 
    }
    blockquote {
      margin: 1rem 0;
      padding-left: 1rem;
      border-left: 3px solid var(--green);
      color: #555;
      font-style: italic;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="chapter-title">Create Simple Algebraic Expressions Using Simple Logic to Translate Instructions into Algebraic Form</h1>
        <div class="lo-tags" id="lo-tags">B7.2.2.1.1</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main id="main-content">
      <!-- === REPLACE THIS SECTION PER LESSON === -->
      <div class="section">
        <h2>üéØ What You‚Äôll Learn</h2>
        <ul id="objectives"></ul>
      </div>

      <div class="section">
        <h2>üî§ Important Words</h2>
        <p id="word-list-desc">Key terms for this lesson:</p>
        <div class="word-list" id="word-list"></div>
      </div>

      <div class="section" id="lesson-content">
        <h3>1. What Is an Algebraic Expression?</h3>
        <p>An <strong>algebraic expression</strong> is a mathematical phrase that includes:</p>
        <ul>
          <li><strong>Numbers</strong> (constants)</li>
          <li><strong>Variables</strong> (letters like x, y)</li>
          <li><strong>Operations</strong> (+, ‚àí, √ó, √∑)</li>
        </ul>
        <blockquote>‚úÖ <strong>Examples</strong>:<br>
        - x + 10<br>
        - 5x - 2<br>
        - 2(5 - 8x)</blockquote>
        <blockquote>‚ùå <strong>Not expressions</strong>: Equations like x + 3 = 7 (these are statements, not expressions).</blockquote>

        <h3>2. Translating Words into Algebraic Expressions</h3>
        <p>Use key words to identify operations:</p>
        <table>
          <thead>
            <tr>
              <th>Verbal Phrase</th>
              <th>Operation</th>
              <th>Algebraic Expression</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>‚ÄúMore than‚Äù / ‚ÄúIncreased by‚Äù</td>
              <td>Addition</td>
              <td>x + 5</td>
            </tr>
            <tr>
              <td>‚ÄúLess than‚Äù / ‚ÄúDecreased by‚Äù</td>
              <td>Subtraction</td>
              <td>x - 3</td>
            </tr>
            <tr>
              <td>‚ÄúTimes‚Äù / ‚ÄúProduct of‚Äù</td>
              <td>Multiplication</td>
              <td>4x or 4¬∑x</td>
            </tr>
            <tr>
              <td>‚ÄúHalf of‚Äù / ‚ÄúDivided by‚Äù</td>
              <td>Division</td>
              <td>x/2 or x √∑ 2</td>
            </tr>
            <tr>
              <td>‚ÄúTimes the sum/difference‚Äù</td>
              <td>Grouping with parentheses</td>
              <td>3(x + 2)</td>
            </tr>
          </tbody>
        </table>
        <blockquote>üí° <strong>Important</strong>: The phrase ‚Äúless than‚Äù <strong>reverses order</strong>:<br>
        - ‚Äú5 less than x‚Äù ‚Üí x - 5 (not 5 - x)</blockquote>

        <h3>3. Worked Examples from Curriculum</h3>
        <p><strong>Example 1: Basic Translations</strong><br>
        Let x represent an unknown number.</p>
        <table>
          <thead>
            <tr>
              <th>Statement</th>
              <th>Algebraic Expression</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>10 more than a number x</td>
              <td>x + 10</td>
            </tr>
            <tr>
              <td>5 less than a number x</td>
              <td>x - 5</td>
            </tr>
            <tr>
              <td>3 times a number x</td>
              <td>3x</td>
            </tr>
            <tr>
              <td>Half of a number x</td>
              <td>x/2 or (1/2)x</td>
            </tr>
            <tr>
              <td>2 more than 5 times x</td>
              <td>5x + 2</td>
            </tr>
            <tr>
              <td>When 8 times x is subtracted from 5 and the result is multiplied by 2</td>
              <td>2(5 - 8x)</td>
            </tr>
          </tbody>
        </table>
        <blockquote>‚úÖ <strong>Note</strong>: Parentheses ensure correct order‚Äîdo the subtraction <strong>before</strong> multiplying.</blockquote>

        <h3>4. Real-Life Contexts</h3>
        <p><strong>Example 2: Age Problems</strong><br>
        Afrako is 3 years older than Maako. If Maako is x years old, what is Afrako‚Äôs age?</p>
        <ul>
          <li>Maako = x</li>
          <li>Afrako = x + 3</li>
        </ul>
        <p>‚úÖ <strong>Expression</strong>: x + 3</p>

        <p><strong>Example 3: Money Sharing</strong><br>
        Agbolosu and Tetteh were given GH‚Çµ400. Tetteh had GH‚Çµ35 more than Agbolosu. If Agbolosu‚Äôs share is x, write an expression for Tetteh‚Äôs share.</p>
        <ul>
          <li>Agbolosu = x</li>
          <li>Tetteh = x + 35</li>
        </ul>
        <p>‚úÖ <strong>Expression</strong>: x + 35</p>
        <blockquote>üìå <strong>Bonus</strong>: Total = x + (x + 35) = 2x + 35</blockquote>

        <p><strong>Example 4: Business & Geometry</strong></p>
        <table>
          <thead>
            <tr>
              <th>Situation</th>
              <th>Expression</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Profit = Selling price ‚àí Cost price</td>
              <td>If cost = x, sell = y ‚Üí Profit = y - x</td>
            </tr>
            <tr>
              <td>Area of rectangle (length t, width q)</td>
              <td>t √ó q = tq</td>
            </tr>
            <tr>
              <td>Perimeter of rectangle (length x, width y)</td>
              <td>2x + 2y or 2(x + y)</td>
            </tr>
          </tbody>
        </table>

        <h3>5. Common Pitfalls to Avoid</h3>
        <table>
          <thead>
            <tr>
              <th>Mistake</th>
              <th>Correction</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Writing ‚Äú5 less than x‚Äù as 5 - x</td>
              <td>‚ùå Should be x - 5</td>
            </tr>
            <tr>
              <td>Forgetting parentheses in grouped operations</td>
              <td>‚ÄúTwice the sum of x and 3‚Äù ‚Üí 2(x + 3), <strong>not</strong> 2x + 3</td>
            </tr>
            <tr>
              <td>Confusing ‚Äúof‚Äù (multiplication) with ‚Äúand‚Äù (addition)</td>
              <td>‚ÄúHalf of x‚Äù = (1/2)x; ‚Äúx and 5‚Äù = x + 5</td>
            </tr>
          </tbody>
        </table>

        <h3>Core Competencies Developed</h3>
        <ul>
          <li><strong>Communication and Collaboration (CC)</strong>: Translating everyday language into precise mathematical form.</li>
          <li><strong>Critical Thinking and Problem Solving (CP)</strong>: Analyzing word problems to identify variables and operations.</li>
          <li><strong>Creativity and Innovation (CI)</strong>: Modeling real-world scenarios with symbols.</li>
        </ul>
      </div>

      <div class="section">
        <h2>‚úÖ Check Your Understanding</h2>
        <div class="checkpoint" id="checkpoint-questions"></div>
      </div>

      <div class="section" id="next-preview">
        <h3>üîú Coming Up</h3>
        <p>In Lesson 35, you‚Äôll learn to simplify algebraic expressions by combining like terms‚Äîsuch as turning 4x + 3x into 7x‚Äîand use these skills to find perimeters, totals, and more!</p>
      </div>
      <!-- === END REPLACE SECTION === -->

      <div id="student-name-prompt" class="section" style="display:none;">
        <h2>üë§ Your Name</h2>
        <div id="name-display"></div>
        <input type="text" id="student-name" placeholder="Enter your name" maxlength="30"
          style="padding:0.5rem;font-size:1rem;width:100%;margin:0.5rem 0;display:none;">
        <div id="name-buttons"></div>
      </div>

      <div class="quiz" id="quiz-container" style="display:none;">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check Answers</button>
      </div>

      <div id="feedback"></div>

      <!-- FOOTER -->
      <footer>
        <a href="../premium.html" style="display:block; margin-bottom:0.5rem;">‚ú® Unlock Premium Features</a>
        <a href="#" id="send-analytics" style="color:#6c757d;">üì§ Send Anonymous Usage Data</a>
        <br>
        <a href="../dashboard.html">üìä View Dashboard</a>
      </footer>
    </main>
  </div>

  <script>
    (function () {
      'use strict';
      window.startTime = Date.now();

      // === Seeded RNG & Shuffle ===
      function createSeededRNG(seed) {
        let state = Math.abs((seed * 9301 + 49297) % 233280);
        return () => {
          state = (state * 9301 + 49297) % 233280;
          return state / 233280;
        };
      }

      function shuffleWithSeed(array, seed) {
        const rng = createSeededRNG(seed);
        const arr = [...array];
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(rng() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
      }

      // === CONFIGURATION ===
      const currentChapter = 33; // ‚Üê UPDATE PER LESSON
      const MAX_CHAPTER = 300;
      const WHATSAPP_NUMBER = "233257320201";

      // === ANALYTICS MODULE ===
      const ANALYTICS_KEY = 'miniopenstax_analytics_consent';
      const EVENTS_KEY = 'miniopenstax_events';

      function isAnalyticsEnabled() {
        return localStorage.getItem(ANALYTICS_KEY) === '1';
      }

      function logEvent(eventType, data = {}) {
        if (!isAnalyticsEnabled()) return;
        const event = { type: eventType, timestamp: Date.now(), lesson: currentChapter, data };
        const events = JSON.parse(localStorage.getItem(EVENTS_KEY) || '[]');
        events.push(event);
        localStorage.setItem(EVENTS_KEY, JSON.stringify(events));
        if (events.length >= 20) sendAnalyticsEvents();
      }

      function enableAnalytics() {
        localStorage.setItem(ANALYTICS_KEY, '1');
      }

      function sendAnalyticsEvents() {
        const events = JSON.parse(localStorage.getItem(EVENTS_KEY) || '[]');
        if (events.length === 0) return;
        const summary = {
          lessons_attempted: [...new Set(events.map(e => e.lesson))].length,
          quizzes_submitted: events.filter(e => e.type === 'quiz_submitted').length,
          mastery_count: events.filter(e => e.type === 'mastery_achieved').length,
          first_event: new Date(events[0].timestamp).toISOString().split('T')[0],
          last_event: new Date(events[events.length - 1].timestamp).toISOString().split('T')[0]
        };
        const report = `*Mini OpenStax ‚Äî Anonymous Usage Report*\n` +
          `Lessons Tried: ${summary.lessons_attempted}\n` +
          `Quizzes Taken: ${summary.quizzes_submitted}\n` +
          `Mastery Achieved: ${summary.mastery_count}\n` +
          `Period: ${summary.first_event} to ${summary.last_event}\n\n` +
          `Thank you for helping improve literacy tools!`;
        localStorage.removeItem(EVENTS_KEY);
        const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(report)}`;
        window.open(url, '_blank');
      }

      // === TYPO CORRECTIONS (for copied content) ===
      const TYPO_CORRECTIONS = [
        [/f resh/g, 'fresh'], [/p unch/g, 'punch'], [/slep t/g, 'slept'],
        [/crep t/g, 'crept'], [/p lant/g, 'plant'], [/p ath/g, 'path'],
        [/f roth/g, 'froth'], [/p eck/g, 'peck'], [/f luck/g, 'pluck'],
        [/p luck/g, 'pluck'], [/f ling/g, 'fling'], [/p ass/g, 'pass'],
        [/f uss/g, 'fuss'], [/sp ell/g, 'spell'], [/f uzz/g, 'fuzz'],
        [/thef t/g, 'theft'], [/thrif t/g, 'thrift'], [/dep th/g, 'depth'],
        [/fif th/g, 'fifth'], [/st ink/g, 'stink'], [/wr ink/g, 'wring']
      ];

      // === CHAPTER CONTENT (EDIT PER FILE) ===
      const CHAPTER_CONFIG = {
        title: "Create Simple Algebraic Expressions Using Simple Logic to Translate Instructions into Algebraic Form",
        loTags: ["B7.2.2.1.1"],
        objectives: [
          "Translate verbal phrases or real-life situations into algebraic expressions.",
          "Use letters (variables) such as x, y, a, etc., to represent unknown quantities.",
          "Apply the correct order of operations when forming expressions.",
          "Interpret and write expressions involving addition, subtraction, multiplication, division, and grouping."
        ],
        words: [
          "Algebraic expression",
          "Variable",
          "Constant",
          "Operation",
          "Grouping",
          "Translate",
          "Order of operations"
        ],
        wordListDesc: "Key terms for this lesson:",
        checkpointQuestions: `
          <ol>
            <li>Let x be a number. Write expressions for:
              <br>a) 7 more than x
              <br>b) 4 less than x
              <br>c) Three times x
              <br>d) Half of x
              <br>e) 5 less than twice x</li>
            <li>Kofi is x years old. His sister is 6 years younger. Write an expression for his sister‚Äôs age.</li>
            <li>A basket of mangoes costs m cedis. A basket of oranges costs o cedis.
              <br>a) What is the total cost of one of each?
              <br>b) What is the profit if both are sold together for s cedis?</li>
            <li>Translate: ‚ÄúSubtract 9 from 4 times a number, then multiply the result by 3.‚Äù</li>
          </ol>
          <p><em>Confirm your understanding before moving on.</em></p>
        `,
        nextPreview: "In Lesson 35, you‚Äôll learn to simplify algebraic expressions by combining like terms‚Äîsuch as turning 4x + 3x into 7x‚Äîand use these skills to find perimeters, totals, and more!",
        assessmentItems: [
          { id: "1", prompt: "Which is an algebraic expression?", options: [
            {id:"a",text:"3x + 5",is_correct:true},
            {id:"b",text:"3x + 5 = 11",is_correct:false},
            {id:"c",text:"x = 2",is_correct:false},
            {id:"d",text:"7 > 5",is_correct:false}
          ]},
          { id: "2", prompt: "‚Äú5 more than x‚Äù is written as:", options: [
            {id:"a",text:"5 + x",is_correct:false},
            {id:"b",text:"x + 5",is_correct:true},
            {id:"c",text:"5x",is_correct:false},
            {id:"d",text:"x - 5",is_correct:false}
          ]},
          { id: "3", prompt: "‚Äú7 less than x‚Äù is written as:", options: [
            {id:"a",text:"7 - x",is_correct:false},
            {id:"b",text:"x - 7",is_correct:true},
            {id:"c",text:"7x",is_correct:false},
            {id:"d",text:"x + 7",is_correct:false}
          ]},
          { id: "4", prompt: "‚ÄúThree times x‚Äù is written as:", options: [
            {id:"a",text:"3 + x",is_correct:false},
            {id:"b",text:"x3",is_correct:false},
            {id:"c",text:"3x",is_correct:true},
            {id:"d",text:"x/3",is_correct:false}
          ]},
          { id: "5", prompt: "‚ÄúHalf of x‚Äù is written as:", options: [
            {id:"a",text:"2x",is_correct:false},
            {id:"b",text:"x/2",is_correct:true},
            {id:"c",text:"x + 2",is_correct:false},
            {id:"d",text:"x - 2",is_correct:false}
          ]},
          { id: "6", prompt: "‚ÄúTwice the sum of x and 4‚Äù is:", options: [
            {id:"a",text:"2x + 4",is_correct:false},
            {id:"b",text:"2(x + 4)",is_correct:true},
            {id:"c",text:"x + 8",is_correct:false},
            {id:"d",text:"2x + 8",is_correct:false}
          ]},
          { id: "7", prompt: "Kwame is x years old. His brother is 3 years older. Brother's age:", options: [
            {id:"a",text:"3x",is_correct:false},
            {id:"b",text:"x + 3",is_correct:true},
            {id:"c",text:"x - 3",is_correct:false},
            {id:"d",text:"3 - x",is_correct:false}
          ]},
          { id: "8", prompt: "‚Äú5 less than twice x‚Äù is:", options: [
            {id:"a",text:"5 - 2x",is_correct:false},
            {id:"b",text:"2x - 5",is_correct:true},
            {id:"c",text:"2(x - 5)",is_correct:false},
            {id:"d",text:"10x",is_correct:false}
          ]},
          { id: "9", prompt: "A book costs x cedis. A pen costs 2 cedis more. Pen cost:", options: [
            {id:"a",text:"2x",is_correct:false},
            {id:"b",text:"x + 2",is_correct:true},
            {id:"c",text:"x - 2",is_correct:false},
            {id:"d",text:"2 - x",is_correct:false}
          ]},
          { id: "10", prompt: "‚ÄúSubtract 6 from 3 times x‚Äù is:", options: [
            {id:"a",text:"6 - 3x",is_correct:false},
            {id:"b",text:"3x - 6",is_correct:true},
            {id:"c",text:"3(x - 6)",is_correct:false},
            {id:"d",text:"18x",is_correct:false}
          ]},
          { id: "11", prompt: "Area of rectangle with length x and width y:", options: [
            {id:"a",text:"x + y",is_correct:false},
            {id:"b",text:"2x + 2y",is_correct:false},
            {id:"c",text:"xy",is_correct:true},
            {id:"d",text:"x/y",is_correct:false}
          ]},
          { id: "12", prompt: "‚ÄúFour times the difference of x and 2‚Äù is:", options: [
            {id:"a",text:"4x - 2",is_correct:false},
            {id:"b",text:"4(x - 2)",is_correct:true},
            {id:"c",text:"8x",is_correct:false},
            {id:"d",text:"4x - 8",is_correct:false}
          ]},
          { id: "13", prompt: "Total cost of x items at GH‚Çµ5 each:", options: [
            {id:"a",text:"5 + x",is_correct:false},
            {id:"b",text:"5x",is_correct:true},
            {id:"c",text:"x/5",is_correct:false},
            {id:"d",text:"5 - x",is_correct:false}
          ]},
          { id: "14", prompt: "‚ÄúMultiply the sum of x and 3 by 2‚Äù is:", options: [
            {id:"a",text:"2x + 3",is_correct:false},
            {id:"b",text:"2(x + 3)",is_correct:true},
            {id:"c",text:"6x",is_correct:false},
            {id:"d",text:"2x + 6",is_correct:false}
          ]},
          { id: "15", prompt: "Profit = selling price - cost. If cost = x, sell = y, profit =", options: [
            {id:"a",text:"x - y",is_correct:false},
            {id:"b",text:"y - x",is_correct:true},
            {id:"c",text:"xy",is_correct:false},
            {id:"d",text:"x + y",is_correct:false}
          ]},
          { id: "16", prompt: "‚ÄúOne-third of x‚Äù is:", options: [
            {id:"a",text:"3x",is_correct:false},
            {id:"b",text:"x/3",is_correct:true},
            {id:"c",text:"x + 3",is_correct:false},
            {id:"d",text:"3/x",is_correct:false}
          ]},
          { id: "17", prompt: "Perimeter of square with side x:", options: [
            {id:"a",text:"x",is_correct:false},
            {id:"b",text:"2x",is_correct:false},
            {id:"c",text:"4x",is_correct:true},
            {id:"d",text:"x¬≤",is_correct:false}
          ]},
          { id: "18", prompt: "‚Äú9 decreased by x‚Äù is:", options: [
            {id:"a",text:"x - 9",is_correct:false},
            {id:"b",text:"9 - x",is_correct:true},
            {id:"c",text:"9x",is_correct:false},
            {id:"d",text:"9/x",is_correct:false}
          ]},
          { id: "19", prompt: "If x = 4, which expression equals 10?", options: [
            {id:"a",text:"x + 4",is_correct:false},
            {id:"b",text:"2x + 2",is_correct:true},
            {id:"c",text:"3x",is_correct:false},
            {id:"d",text:"x/2",is_correct:false}
          ]},
          { id: "20", prompt: "‚ÄúThe product of 5 and x, increased by 3‚Äù is:", options: [
            {id:"a",text:"5(x + 3)",is_correct:false},
            {id:"b",text:"5x + 3",is_correct:true},
            {id:"c",text:"15x",is_correct:false},
            {id:"d",text:"5 + 3x",is_correct:false}
          ]}
        ]
      };

      // === RENDERING FUNCTIONS ===
      function renderContent() {
        document.getElementById('chapter-title').textContent = CHAPTER_CONFIG.title;
        document.getElementById('lo-tags').textContent = CHAPTER_CONFIG.loTags[0];

        // Objectives
        document.getElementById('objectives').innerHTML =
          CHAPTER_CONFIG.objectives.map(obj => `<li>${obj}</li>`).join('');

        // Words
        document.getElementById('word-list-desc').textContent = CHAPTER_CONFIG.wordListDesc;
        document.getElementById('word-list').innerHTML =
          CHAPTER_CONFIG.words.map(w => `<span class="word-item">${w}</span>`).join('');

        // Checkpoint
        document.getElementById('checkpoint-questions').innerHTML = CHAPTER_CONFIG.checkpointQuestions;

        // Next preview
        document.getElementById('next-preview').innerHTML = `
          <h3>üîú Coming Up</h3>
          <p>${CHAPTER_CONFIG.nextPreview}</p>
        `;
      }

      function renderNavigation() {
        const nav = document.getElementById('chapter-nav');
        const buttons = [{ label: "Home", url: "../index.html", active: false }];
        for (let i = 0; i < 4; i++) {
          const c = currentChapter + i;
          const lessonNum = c + 1;
          if (c > MAX_CHAPTER) break;
          buttons.push({
            label: `Lesson ${lessonNum}`,
            url: `chapter-${c}.html`,
            active: i === 0
          });
        }
        nav.innerHTML = buttons.map(b =>
          `<a href="${b.url}" class="chapter-btn ${b.active ? 'active' : ''}">${b.label}</a>`
        ).join('');
      }

      function renderQuiz() {
        const form = document.getElementById('quiz-form');
        window.quizCorrectMap = {};
        const baseSeed = currentChapter * 1000000 + (Date.now() % 1000000);

        form.innerHTML = CHAPTER_CONFIG.assessmentItems.map(q => {
          const seed = baseSeed + parseInt(q.id, 10);
          const shuffledOpts = shuffleWithSeed([...q.options], seed);
          const correct = q.options.find(o => o.is_correct);
          window.quizCorrectMap[q.id] = correct.id;

          const optHtml = shuffledOpts.map((opt, idx) => {
            const letter = String.fromCharCode(65 + idx);
            return `<div class="option"><label><input type="radio" name="q${q.id}" value="${opt.id}" required> ${letter}. ${opt.text}</label></div>`;
          }).join('');

          return `<div class="question"><strong>${q.id}. ${q.prompt}</strong><div class="options">${optHtml}</div></div>`;
        }).join('');
      }

      function showFeedback(answers) {
        const items = CHAPTER_CONFIG.assessmentItems;
        let correctCount = 0, correctList = [], incorrectList = [];

        items.forEach((item, i) => {
          const ans = answers[i];
          const correctId = window.quizCorrectMap[item.id];
          const correctOpt = item.options.find(o => o.id === correctId);
          const isCorrect = ans === correctId;
          if (isCorrect) {
            correctCount++;
            correctList.push(`${item.id}. ${item.prompt} ‚Üí ‚úÖ ${correctOpt.text}`);
          } else {
            incorrectList.push(`${item.id}. ${item.prompt} ‚Üí ‚ùå Your answer: ${item.options.find(o => o.id === ans)?.text || '‚Äî'} | ‚úÖ ${correctOpt.text}`);
          }
        });

        const score = correctCount, total = 20, mastery = score >= 15;
        const timeOnTask = Math.floor((Date.now() - window.startTime) / 1000);
        const attempts = (parseInt(localStorage.getItem(`quiz_attempts_${currentChapter}`)) || 0) + 1;
        localStorage.setItem(`quiz_attempts_${currentChapter}`, attempts);
        localStorage.setItem(`mastery_${currentChapter}`, mastery ? '1' : '0');
        const studentName = localStorage.getItem('student_name') || '[Name]';

        logEvent('quiz_submitted', { score, time_sec: timeOnTask, mastery, attempts });
        if (mastery) logEvent('mastery_achieved', {});

        let report = `*Mini OpenStax ‚Äî ${CHAPTER_CONFIG.title}*\nStudent: ${studentName}\nScore: ${score}/${total} (${Math.round(score/total*100)}%) ‚Äî ${mastery ? '‚úÖ MASTERED' : '‚ùå Needs Review'}\nTime: ${timeOnTask}s | Attempts: ${attempts}\n\n`;
        if (correctList.length) report += `‚úÖ CORRECT (${correctList.length}):\n${correctList.join('\n')}\n\n`;
        if (incorrectList.length) report += `‚ùå INCORRECT (${incorrectList.length}):\n${incorrectList.join('\n')}\n\n`;
        report += `Report generated via Mini OpenStax.`;

        localStorage.setItem(`saved_report_${currentChapter}_${Date.now()}`, report);

        const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(report)}`;
        document.getElementById('feedback').innerHTML = `
          <div class="feedback">
            <h3>üìä Results: ${score}/${total}</h3>
            <p><strong>${mastery ? 'üéâ Excellent!' : score >= 10 ? 'Good!' : 'Keep practicing.'}</strong> ${
              mastery ? 'You‚Äôve mastered the concept!' :
              score >= 10 ? 'Review missed items.' : 'Practice this lesson again.'
            }</p>
            <p><strong>Time:</strong> ${timeOnTask}s | <strong>Attempts:</strong> ${attempts}</p>
            <a href="${url}" target="_blank" class="btn" style="background:#25D366;text-decoration:none;">
              üì≤ Send Report via WhatsApp
            </a>
          </div>
        `;
      }

      function setupQuizListeners() {
        document.getElementById('submit-quiz').addEventListener('click', () => {
          const form = document.getElementById('quiz-form');
          const answers = [];
          for (let i = 1; i <= 20; i++) {
            const el = form.querySelector(`input[name="q${i}"]:checked`);
            answers.push(el ? el.value : null);
          }
          if (answers.includes(null)) {
            alert("Please answer all questions.");
            return;
          }
          showFeedback(answers);
        });
      }

      function initNamePrompt() {
        const saved = localStorage.getItem('student_name');
        const savedRole = localStorage.getItem('user_role') || 'student';
        const promptDiv = document.getElementById('student-name-prompt');
        const quizDiv = document.getElementById('quiz-container');
        const display = document.getElementById('name-display');
        const input = document.getElementById('student-name');
        const buttons = document.getElementById('name-buttons');
        const roleBadge = document.querySelector('.role-badge');
        roleBadge.textContent = savedRole === 'instructor' ? 'Instructor View' : 'Student View';

        if (saved) {
          promptDiv.style.display = 'block';
          quizDiv.style.display = 'none';
          display.innerHTML = `<p><strong>Current name:</strong> ${saved} (${savedRole})</p>`;
          buttons.innerHTML = `
            <button type="button" class="btn" id="keep-btn">‚úÖ Keep This Name</button>
            <button type="button" class="btn btn-secondary" id="change-btn">‚úèÔ∏è Use a Different Name</button>
          `;
          document.getElementById('keep-btn').onclick = () => {
            promptDiv.style.display = 'none';
            quizDiv.style.display = 'block';
            logEvent('lesson_start', {});
          };
          document.getElementById('change-btn').onclick = () => {
            display.style.display = 'none';
            input.style.display = 'block';
            buttons.innerHTML = `
              <button type="button" class="btn" id="save-new">üíæ Save and Start Quiz</button>
              <div style="margin-top:1rem; font-size:0.9rem;">
                <label>
                  <input type="checkbox" id="teacher-mode"> 
                  I'm an instructor (analytics auto-enabled to improve lessons)
                </label>
              </div>
            `;
            input.value = '';
            input.focus();
            document.getElementById('save-new').onclick = () => {
              const name = input.value.trim();
              if (name) {
                localStorage.setItem('student_name', name);
                const isTeacher = document.getElementById('teacher-mode').checked;
                localStorage.setItem('user_role', isTeacher ? 'instructor' : 'student');
                if (isTeacher) enableAnalytics();
                promptDiv.style.display = 'none';
                quizDiv.style.display = 'block';
                roleBadge.textContent = isTeacher ? 'Instructor View' : 'Student View';
                logEvent('lesson_start', {});
              } else {
                alert("Please enter your name.");
                input.focus();
              }
            };
          };
        } else {
          promptDiv.style.display = 'block';
          quizDiv.style.display = 'none';
          display.style.display = 'none';
          input.style.display = 'block';
          buttons.innerHTML = `
            <button type="button" class="btn" id="save-first">üíæ Save and Start Quiz</button>
            <div style="margin-top:1rem; font-size:0.9rem;">
              <label>
                <input type="checkbox" id="teacher-mode"> 
                I'm an instructor (analytics auto-enabled to improve lessons)
              </label>
            </div>
          `;
          document.getElementById('save-first').onclick = () => {
            const name = input.value.trim();
            if (name) {
              localStorage.setItem('student_name', name);
              const isTeacher = document.getElementById('teacher-mode').checked;
              localStorage.setItem('user_role', isTeacher ? 'instructor' : 'student');
              if (isTeacher) enableAnalytics();
              promptDiv.style.display = 'none';
              quizDiv.style.display = 'block';
              roleBadge.textContent = isTeacher ? 'Instructor View' : 'Student View';
              logEvent('lesson_start', {});
            } else {
              alert("Please enter your name.");
              input.focus();
            }
          };
        }
      }

      function init() {
        renderContent();
        renderNavigation();
        renderQuiz();
        setupQuizListeners();
        initNamePrompt();
      }

      document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('send-analytics').onclick = (e) => {
          e.preventDefault();
          if (confirm('Send anonymous usage data to help improve Mini OpenStax?')) {
            sendAnalyticsEvents();
          }
        };
      });

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>
