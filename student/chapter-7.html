<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Mini OpenStax: Apply Mental Mathematics Strategies to Solve Word Problems" />
  <title>Mini OpenStax ‚Äî Apply Mental Math to Solve Word Problems</title>
  <style>
    :root {
      --green: #006b3d;   /* Ghana green */
      --gold: #cead00;    /* Ghana gold */
      --light: #f9f9f9;
      --dark: #2d2d2d;
    }
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      margin: 0;
      padding: 0;
      background: #fff;
      color: var(--dark);
      line-height: 1.6;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 1rem;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    .role-badge {
      background: #e9ecef;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.85rem;
    }
    .chapter-nav {
      margin: 1.2rem 0;
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      justify-content: center;
    }
    .chapter-btn {
      padding: 0.4rem 0.8rem;
      background: var(--green);
      color: white;
      text-decoration: none;
      border-radius: 4px;
      font-size: 0.9rem;
      min-width: 80px;
      text-align: center;
    }
    .chapter-btn.active,
    .chapter-btn:hover {
      background: #00502e;
    }
    .section {
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid #eee;
    }
    .word-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin: 0.5rem 0;
    }
    .word-item {
      background: var(--light);
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-family: monospace;
      font-size: 0.95rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0.5rem;
      text-align: left;
    }
    th {
      background-color: #f0f7f4;
    }
    .checkpoint, .thought-experiment {
      background: #f8f9fa;
      padding: 1rem;
      border-left: 4px solid var(--gold);
      margin: 1.5rem 0;
    }
    .quiz {
      margin-top: 2rem;
    }
    .question {
      margin-bottom: 1.2rem;
    }
    .options {
      margin-left: 1rem;
    }
    .option {
      margin: 0.4rem 0;
    }
    .btn {
      background: var(--green);
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
      margin-right: 0.5rem;
      display: inline-block;
    }
    .btn:hover {
      background: #00502e;
    }
    .btn-secondary {
      background: #6c757d;
    }
    .btn-secondary:hover {
      background: #5a6268;
    }
    .feedback {
      margin-top: 1.5rem;
      padding: 1rem;
      background: var(--light);
      border-left: 4px solid var(--green);
    }
    footer {
      text-align: center;
      margin-top: 2rem;
      font-size: 0.9rem;
      padding-top: 1.5rem;
      border-top: 1px solid #eee;
    }
    a {
      color: var(--green);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    blockquote {
      margin: 1rem 0;
      padding-left: 1rem;
      border-left: 3px solid var(--green);
      color: #555;
      font-style: italic;
    }
    .preview-next {
      background: #e8f5e9;
      padding: 1rem;
      border-radius: 6px;
      margin-top: 1.5rem;
    }
    code {
      background: #f1f1f1;
      padding: 0.1rem 0.3rem;
      border-radius: 3px;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="lesson-title">Apply Mental Mathematics Strategies to Solve Word Problems</h1>
        <div class="lo-tags" id="lo-tag">B7.1.2.1.3</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <!-- Navigation: Home + Current + Next 3 -->
    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main>
      <!-- Learning Objectives -->
      <div class="section">
        <h2>üéØ What You‚Äôll Learn</h2>
        <ul id="objectives">
          <li>Identify key information and operations in real-life word problems.</li>
          <li>Select and apply appropriate <strong>mental math strategies</strong> (e.g., compensation, decomposition, rounding, doubling/halving) to solve problems efficiently.</li>
          <li>Justify your reasoning using clear mathematical language.</li>
          <li>Check the reasonableness of your answer using estimation or inverse operations.</li>
        </ul>
      </div>

      <!-- Word List -->
      <div class="section">
        <h2>üî§ Important Words</h2>
        <p id="word-list-desc">Key terms for this lesson:</p>
        <div class="word-list" id="word-list">
          <span class="word-item">compensation</span>
          <span class="word-item">decomposition</span>
          <span class="word-item">rounding</span>
          <span class="word-item">doubling and halving</span>
          <span class="word-item">estimation</span>
          <span class="word-item">word problem</span>
          <span class="word-item">reasonableness</span>
          <span class="word-item">inverse operation</span>
        </div>
      </div>

      <!-- Lesson Content -->
      <div class="section" id="lesson-content">
        <h3>1. Steps for Solving Word Problems Mentally</h3>
        <p>Use the <strong>READ‚ÄìPLAN‚ÄìSOLVE‚ÄìCHECK</strong> framework:</p>
        <ol>
          <li><strong>READ</strong>: Understand what is given and what is asked.</li>
          <li><strong>PLAN</strong>: Choose a mental strategy based on numbers and context.</li>
          <li><strong>SOLVE</strong>: Carry out the calculation mentally using properties or shortcuts.</li>
          <li><strong>CHECK</strong>: Estimate or use the opposite operation to verify.</li>
        </ol>
        <blockquote>
          üí° <strong>Tip</strong>: Underline or highlight numbers and keywords like ‚Äútotal,‚Äù ‚Äúdifference,‚Äù ‚Äúeach,‚Äù ‚Äúmore than,‚Äù etc.
        </blockquote>

        <h3>2. Common Mental Strategies in Context</h3>
        <p><strong>A. Compensation (Adjust-and-Correct)</strong><br>
        Best when numbers are <strong>close to round values</strong>.</p>
        <blockquote>
          <strong>Example</strong>:<br>
          A school bought 998 notebooks at GH‚Çµ5 each. How much did they spend?<br>
          ‚Üí Think: 1,000 √ó 5 = 5,000<br>
          ‚Üí But they bought <strong>2 fewer</strong>, so subtract 2 √ó 5 = 10<br>
          ‚Üí <strong>Answer: GH‚Çµ4,990</strong>
        </blockquote>

        <p><strong>B. Decomposition (Break Apart by Place Value)</strong><br>
        Ideal for large or multi-digit numbers.</p>
        <blockquote>
          <strong>Example</strong>:<br>
          A town has a population of 2,687,500. If 1,187,500 are adults, how many are children?<br>
          ‚Üí Subtract:<br>
          2,687,500 - 1,187,500 = (2,687.5 - 1,187.5) thousand = <strong>1,500,000</strong><br>
          ‚Üí <strong>Answer: 1,500,000 children</strong>
        </blockquote>

        <p><strong>C. Doubling and Halving (for Multiplication)</strong><br>
        Useful with even numbers or friendly factors.</p>
        <blockquote>
          <strong>Example</strong>:<br>
          A truck carries 25 boxes, each weighing 48 kg. What‚Äôs the total weight?<br>
          ‚Üí Halve 48 ‚Üí 24<br>
          ‚Üí Double 25 ‚Üí 50<br>
          ‚Üí 24 √ó 50 = <strong>1,200 kg</strong><br>
          ‚Üí <strong>Answer: 1,200 kg</strong>
        </blockquote>

        <p><strong>D. Using Known Facts & Patterns</strong><br>
        Leverage multiples of 10, 25, 50, 100, or familiar sequences.</p>
        <blockquote>
          <strong>Example</strong>:<br>
          The sequence of grants is: 187,500; 687,500; 1,187,500‚Ä¶ How much is the 5th grant?<br>
          ‚Üí Pattern: +500,000 each time<br>
          ‚Üí 1st: 187,500<br>
          ‚Üí 2nd: +500k ‚Üí 687,500<br>
          ‚Üí 3rd: 1,187,500<br>
          ‚Üí 4th: 1,687,500<br>
          ‚Üí <strong>5th: 2,187,500</strong>
        </blockquote>

        <p><strong>E. Rounding for Estimation (to Check Reasonableness)</strong><br>
        Round numbers before calculating to predict approximate answer.</p>
        <blockquote>
          <strong>Example</strong>:<br>
          Is 4,892 √ó 60 ‚âà 300,000?<br>
          ‚Üí Round 4,892 ‚Üí 5,000<br>
          ‚Üí 5,000 √ó 60 = <strong>300,000</strong> ‚Üí Yes, reasonable!
        </blockquote>

        <h3>3. Real-World Problem Types</h3>
        <table>
          <thead>
            <tr>
              <th>Context</th>
              <th>Strategy</th>
              <th>Example</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Finance</strong></td>
              <td>Compensation, multiples of 10/100</td>
              <td>Calculating total cost of 199 items at GH‚Çµ12 each</td>
            </tr>
            <tr>
              <td><strong>Population/Demographics</strong></td>
              <td>Decomposition, place value</td>
              <td>Finding difference between city populations over 1 billion</td>
            </tr>
            <tr>
              <td><strong>Measurement</strong></td>
              <td>Unit conversion + mental scaling</td>
              <td>Converting km to m (√ó1,000) mentally</td>
            </tr>
            <tr>
              <td><strong>Sequences & Patterns</strong></td>
              <td>Recognizing common difference</td>
              <td>Predicting next term in: 187,500, 687,500, ‚Ä¶</td>
            </tr>
          </tbody>
        </table>
        <div class="thought-experiment">
          <strong>Thought Experiment</strong>:<br>
          Ghana‚Äôs education budget increased from GH‚Çµ12,187,500,000 to GH‚Çµ12,687,500,000. By how much did it increase?<br>
          ‚Üí Notice both share ‚Äú12,_ _ _,500,000‚Äù<br>
          ‚Üí Difference: 12,687.5M - 12,187.5M = <strong>500,000,000</strong><br>
          ‚Üí <strong>Answer: GH‚Çµ500 million</strong>
        </div>

        <h3>Core Competencies Developed</h3>
        <ul>
          <li><strong>Critical Thinking and Problem Solving (CP)</strong>: Choosing efficient strategies based on number structure.</li>
          <li><strong>Communication and Collaboration (CC)</strong>: Explaining your mental process clearly (‚ÄúI used compensation because‚Ä¶‚Äù).</li>
          <li><strong>Personal Development and Leadership (PL)</strong>: Building confidence in solving real-life quantitative challenges without calculators.</li>
        </ul>
      </div>

      <!-- Checkpoint Questions -->
      <div class="section">
        <h2>‚úÖ Check Your Understanding</h2>
        <div class="checkpoint" id="checkpoint-questions">
          <ol>
            <li><strong>Shopping</strong>: Apples cost GH‚Çµ3.98 each. How much for 5 apples? (Use compensation.)</li>
            <li><strong>Population</strong>: City A has 3,687,500 people. City B has 1,187,500 fewer. What‚Äôs City B‚Äôs population?</li>
            <li><strong>Pattern Recognition</strong>: In the sequence below, what is the <strong>8th term</strong>?<br>
              <code>187,500 &nbsp; 687,500 &nbsp; 1,187,500 &nbsp; ...</code>
            </li>
            <li><strong>Verification</strong>: A student says 249 √ó 4 = 996. Use mental math to check if this is reasonable.</li>
          </ol>
          <p><em>Confirm your answers before moving forward.</em></p>
        </div>
      </div>

      <!-- Preview Next Lesson -->
      <div class="preview-next" id="next-preview">
        <h3>üîú Coming Up</h3>
        <p>In Lesson 9, we‚Äôll explore <strong>factors, multiples, and divisibility rules</strong> for large numbers‚Äîincluding how to find <strong>common factors</strong> and <strong>prime factorizations</strong> of numbers over one billion.</p>
        <p>You‚Äôll also learn how these concepts support simplification, fraction work, and problem-solving in algebra.</p>
      </div>

      <!-- === QUIZ & NAME PROMPT (DO NOT EDIT BELOW) === -->

      <div id="student-name-prompt" class="section" style="display:none;">
        <h2>üë§ Your Name</h2>
        <div id="name-display"></div>
        <input type="text" id="student-name" placeholder="Enter your name" maxlength="30"
          style="padding:0.5rem;font-size:1rem;width:100%;margin:0.5rem 0;display:none;">
        <div id="name-buttons"></div>
      </div>

      <div class="quiz" id="quiz-container" style="display:none;">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check My Answers</button>
      </div>

      <div id="feedback"></div>

      <!-- Footer -->
      <footer>
        <a href="../premium.html" style="display:block; margin-bottom:0.5rem;">‚ú® Unlock Premium Features</a>
        <a href="#" id="send-analytics" style="color:#6c757d;">üì§ Send Anonymous Usage Data</a>
        <br>
        <a href="../dashboard.html">üìä View My Progress</a>
      </footer>
    </main>
  </div>

  <script>
    // ==============================
    // üîß CONFIGURE PER CHAPTER
    // ==============================
    const currentChapter = 7; // ‚Üê Lesson 8 (zero-indexed)
    const WHATSAPP_NUMBER = "233257320201";
    window.startTime = Date.now();

    // ==============================
    // üß† LESSON CONTENT
    // ==============================
    const LESSON_CONFIG = {
      title: "Apply Mental Mathematics Strategies to Solve Word Problems",
      loTag: "B7.1.2.1.3",
      objectives: [
        "Identify key information and operations in real-life word problems.",
        "Select and apply appropriate mental math strategies (e.g., compensation, decomposition, rounding, doubling/halving) to solve problems efficiently.",
        "Justify your reasoning using clear mathematical language.",
        "Check the reasonableness of your answer using estimation or inverse operations."
      ],
      words: [
        "compensation",
        "decomposition",
        "rounding",
        "doubling and halving",
        "estimation",
        "word problem",
        "reasonableness",
        "inverse operation"
      ],
      wordListDesc: "Key terms for this lesson:",
      checkpointQuestions: `
        <ol>
          <li><strong>Shopping</strong>: Apples cost GH‚Çµ3.98 each. How much for 5 apples? (Use compensation.)</li>
          <li><strong>Population</strong>: City A has 3,687,500 people. City B has 1,187,500 fewer. What‚Äôs City B‚Äôs population?</li>
          <li><strong>Pattern Recognition</strong>: In the sequence below, what is the <strong>8th term</strong>?<br>
            <code>187,500 &nbsp; 687,500 &nbsp; 1,187,500 &nbsp; ...</code>
          </li>
          <li><strong>Verification</strong>: A student says 249 √ó 4 = 996. Use mental math to check if this is reasonable.</li>
        </ol>
        <p><em>Confirm your answers before moving forward.</em></p>
      `,
      nextPreview: "In Lesson 9, we‚Äôll explore factors, multiples, and divisibility rules for large numbers‚Äîincluding how to find common factors and prime factorizations of numbers over one billion.\n\nYou‚Äôll also learn how these concepts support simplification, fraction work, and problem-solving in algebra."
    };

    // ==============================
    // üìù QUIZ ITEMS (20 QUESTIONS)
    // ==============================
    const QUIZ_ITEMS = [
      { q: "What does the 'C' in READ‚ÄìPLAN‚ÄìSOLVE‚ÄìCHECK stand for?", a: "Check", opts: ["Calculate", "Confirm", "Check", "Complete"] },
      { q: "Apples cost GH‚Çµ3.98 each. Total for 5? (Use compensation)", a: "GH‚Çµ19.90", opts: ["GH‚Çµ20.00", "GH‚Çµ19.90", "GH‚Çµ19.98", "GH‚Çµ18.90"] },
      { q: "City A: 3,687,500. City B has 1,187,500 fewer. City B?", a: "2,500,000", opts: ["2,500,000", "2,687,500", "1,500,000", "4,875,000"] },
      { q: "Sequence: 187,500; 687,500; 1,187,500... What's the 8th term?", a: "3,687,500", opts: ["3,187,500", "3,687,500", "4,187,500", "2,687,500"] },
      { q: "Is 249 √ó 4 = 996 reasonable?", a: "Yes, because 250√ó4=1,000, so 249√ó4=996", opts: ["No", "Yes, because 250√ó4=1,000, so 249√ó4=996", "Only if rounded", "Can't tell"] },
      { q: "Which strategy works best for 998 √ó 5?", a: "Compensation", opts: ["Long multiplication", "Decomposition", "Compensation", "Guessing"] },
      { q: "2,687,500 - 1,187,500 =", a: "1,500,000", opts: ["1,500,000", "1,400,000", "1,687,500", "1,187,500"] },
      { q: "25 boxes √ó 48 kg: best strategy?", a: "Doubling and halving", opts: ["Add 25 forty-eight times", "Doubling and halving", "Calculator", "Skip"] },
      { q: "Round 4,892 to nearest thousand:", a: "5,000", opts: ["4,000", "4,900", "5,000", "4,890"] },
      { q: "Ghana‚Äôs budget increased from 12,187.5M to 12,687.5M. Increase?", a: "GH‚Çµ500 million", opts: ["GH‚Çµ50 million", "GH‚Çµ500 million", "GH‚Çµ1 billion", "GH‚Çµ187.5 million"] },
      { q: "Keyword 'each' usually means:", a: "Multiplication", opts: ["Addition", "Subtraction", "Multiplication", "Division"] },
      { q: "To check 249 √ó 4 = 996, you could:", a: "Divide 996 by 4", opts: ["Add 249 four times", "Divide 996 by 4", "Multiply by 5", "Round to 250"] },
      { q: "Common difference in 187,500; 687,500...?", a: "500,000", opts: ["187,500", "500,000", "687,500", "1,000,000"] },
      { q: "1st term = 187,500, common diff = 500,000. 4th term?", a: "1,687,500", opts: ["1,187,500", "1,687,500", "2,187,500", "687,500"] },
      { q: "Which is NOT part of READ‚ÄìPLAN‚ÄìSOLVE‚ÄìCHECK?", a: "Write", opts: ["Read", "Plan", "Write", "Check"] },
      { q: "Mental math builds confidence in:", a: "Solving real-life problems without calculators", opts: ["Memorizing tables", "Solving real-life problems without calculators", "Using phones", "Avoiding math"] },
      { q: "Best way to solve 199 √ó 12 mentally?", a: "200√ó12 - 12 = 2,400 - 12 = 2,388", opts: ["199√ó10 + 199√ó2", "200√ó12 - 12 = 2,400 - 12 = 2,388", "Add 199 twelve times", "All of the above"] },
      { q: "Why estimate before solving?", a: "To check reasonableness", opts: ["To waste time", "To check reasonableness", "To avoid exact answer", "To confuse yourself"] },
      { q: "Unit conversion: 5 km to meters?", a: "5,000 m", opts: ["500 m", "5,000 m", "50,000 m", "50 m"] },
      { q: "Mental math supports which competency most?", a: "Critical Thinking and Problem Solving", opts: ["Art", "Critical Thinking and Problem Solving", "Reading", "Writing"] }
    ];

    // ==============================
    // ‚öôÔ∏è CORE FUNCTIONS (DO NOT EDIT)
    // ==============================

    // --- Navigation (Unlimited Chapters) ---
    function renderNavigation() {
      const nav = document.getElementById('chapter-nav');
      const buttons = [];

      // Button 1: Home
      buttons.push({ label: "Home", url: "../index.html", active: false });

      // Buttons 2‚Äì5: Current + next 3 lessons
      for (let i = 0; i < 4; i++) {
        const chap = currentChapter + i;
        buttons.push({
          label: `Lesson ${chap + 1}`,
          url: `chapter-${chap}.html`,
          active: i === 0
        });
      }

      nav.innerHTML = buttons.map(btn =>
        `<a href="${btn.url}" class="chapter-btn ${btn.active ? 'active' : ''}">${btn.label}</a>`
      ).join('');
    }

    // --- Simple Shuffle ---
    function shuffle(array) {
      const arr = [...array];
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // --- Render Content ---
    function renderContent() {
      document.getElementById('lesson-title').textContent = LESSON_CONFIG.title;
      document.getElementById('lo-tag').textContent = LESSON_CONFIG.loTag;

      // Objectives
      document.getElementById('objectives').innerHTML =
        LESSON_CONFIG.objectives.map(obj => `<li>${obj}</li>`).join('');

      // Words
      document.getElementById('word-list-desc').textContent = LESSON_CONFIG.wordListDesc;
      document.getElementById('word-list').innerHTML =
        LESSON_CONFIG.words.map(w => `<span class="word-item">${w}</span>`).join('');

      // Checkpoint
      document.getElementById('checkpoint-questions').innerHTML = LESSON_CONFIG.checkpointQuestions;

      // Next preview
      document.getElementById('next-preview').innerHTML = `
        <h3>üîú Coming Up</h3>
        <p>${LESSON_CONFIG.nextPreview.replace(/\n/g, '<br>')}</p>
      `;
    }

    // --- Quiz Rendering ---
    function renderQuiz() {
      const form = document.getElementById('quiz-form');
      let html = '';
      QUIZ_ITEMS.forEach((item, idx) => {
        const num = idx + 1;
        const opts = shuffle(item.opts);
        html += `<div class="question"><strong>${num}. ${item.q}</strong><div class="options">`;
        opts.forEach(opt => {
          const letter = String.fromCharCode(65 + opts.indexOf(opt));
          html += `<div class="option"><label><input type="radio" name="q${num}" value="${opt}" required> ${letter}. ${opt}</label></div>`;
        });
        html += `</div></div>`;
      });
      form.innerHTML = html;
    }

    // --- Feedback & WhatsApp ---
    function showFeedback() {
      const answers = [];
      for (let i = 1; i <= QUIZ_ITEMS.length; i++) {
        const el = document.querySelector(`input[name="q${i}"]:checked`);
        answers.push(el ? el.value : null);
      }
      if (answers.includes(null)) {
        alert("Please answer all questions.");
        return;
      }

      let correct = 0;
      QUIZ_ITEMS.forEach((item, i) => {
        if (answers[i] === item.a) correct++;
      });

      const score = correct;
      const total = QUIZ_ITEMS.length;
      const mastery = score >= Math.ceil(total * 0.75); // 75% = mastery
      const timeSec = Math.floor((Date.now() - window.startTime) / 1000);
      const attempts = (parseInt(localStorage.getItem(`attempts_${currentChapter}`)) || 0) + 1;
      localStorage.setItem(`attempts_${currentChapter}`, attempts);
      localStorage.setItem(`mastery_${currentChapter}`, mastery ? '1' : '0');
      const name = localStorage.getItem('student_name') || '[Name]';

      const msg = `*Mini OpenStax ‚Äî ${LESSON_CONFIG.title}*\nStudent: ${name}\nScore: ${score}/${total} (${Math.round(score/total*100)}%) ‚Äî ${mastery ? '‚úÖ MASTERED' : '‚ùå Needs Review'}\nTime: ${timeSec}s | Attempts: ${attempts}`;
      const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;

      document.getElementById('feedback').innerHTML = `
        <div class="feedback">
          <h3>üìä Results: ${score}/${total}</h3>
          <p><strong>${mastery ? 'üéâ Excellent!' : score >= total/2 ? 'Good effort!' : 'Keep practicing.'}</strong></p>
          <p>${mastery ? 'You‚Äôve mastered this lesson!' : 'Review and try again.'}</p>
          <p><strong>Time:</strong> ${timeSec}s | <strong>Attempts:</strong> ${attempts}</p>
          <a href="${url}" target="_blank" class="btn" style="background:#25D366;text-decoration:none;">üì≤ Send Report</a>
        </div>
      `;
    }

    // --- Name Prompt ---
    function setupNamePrompt() {
      const saved = localStorage.getItem('student_name');
      const promptDiv = document.getElementById('student-name-prompt');
      const quizDiv = document.getElementById('quiz-container');

      if (saved) {
        promptDiv.style.display = 'block';
        quizDiv.style.display = 'none';
        document.getElementById('name-display').innerHTML = `<p><strong>Name saved:</strong> ${saved}</p>`;
        document.getElementById('name-buttons').innerHTML = `
          <button class="btn" onclick="startQuiz()">‚úÖ Keep This Name</button>
          <button class="btn btn-secondary" onclick="askForNewName()">‚úèÔ∏è Use a Different Name</button>
        `;
      } else {
        askForNewName();
      }
    }

    // Global functions for button clicks
    window.startQuiz = () => {
      document.getElementById('student-name-prompt').style.display = 'none';
      document.getElementById('quiz-container').style.display = 'block';
    };
    window.askForNewName = () => {
      document.getElementById('student-name-prompt').style.display = 'block';
      document.getElementById('quiz-container').style.display = 'none';
      document.getElementById('name-display').style.display = 'none';
      document.getElementById('student-name').style.display = 'block';
      document.getElementById('student-name').value = '';
      document.getElementById('name-buttons').innerHTML = `
        <button class="btn" onclick="saveName()">üíæ Save and Start Quiz</button>
        <div style="margin-top:1rem; font-size:0.9rem;">
          <label><input type="checkbox" id="teacher-mode"> I'm a teacher (help improve lessons)</label>
        </div>
      `;
    };
    window.saveName = () => {
      const name = document.getElementById('student-name').value.trim();
      if (!name) { alert("Please enter your name."); return; }
      localStorage.setItem('student_name', name);
      if (document.getElementById('teacher-mode').checked) {
        localStorage.setItem('miniopenstax_analytics_consent', '1');
      }
      window.startQuiz();
    };

    // --- Initialize Page ---
    function init() {
      renderNavigation();
      renderContent();
      renderQuiz();
      document.getElementById('submit-quiz').onclick = showFeedback;
      setupNamePrompt();
    }

    // Analytics toggle
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('send-analytics').onclick = (e) => {
        e.preventDefault();
        if (confirm('Send anonymous usage data to help improve Mini OpenStax?')) {
          localStorage.setItem('miniopenstax_analytics_consent', '1');
          alert('Analytics enabled. Thank you!');
        }
      };
      init();
    });
  </script>
</body>
</html>
